# Java Thread μΈν„°λ½νΈ μ •λ¦¬

## 1. λ³€μ κΈ°λ° μ¤λ λ“ μ¤‘λ‹¨ vs μΈν„°λ½νΈ κΈ°λ° μ¤‘λ‹¨

### 1.1 λ³€μ κΈ°λ° μ¤‘λ‹¨μ ν•κ³„
```java
// Interrupt.java μμ‹
volatile boolean runFlag = true;

while (runFlag) {
    Utils.logger("μ‘μ—… μ¤‘");
    Utils.timeSleep(3000); // 3μ΄κ°„ λ€κΈ°
}
```

**λ¬Έμ μ : μ¦‰μ‹ μ¤‘λ‹¨λμ§€ μ•λ” μ΄μ **
- `runFlag = false`λ΅ μ„¤μ •ν•΄λ„ **ν„μ¬ μ‹¤ν–‰ μ¤‘μΈ μ‘μ—…μ΄ μ™„λ£λ  λ•κΉμ§€ κΈ°λ‹¤λ ¤μ•Ό ν•¨**
- `Utils.timeSleep(3000)` μ‹¤ν–‰ μ¤‘μ—λ” `while` μ΅°κ±΄μ„ μ²΄ν¬ν•μ§€ μ•μ
- **μµλ€ 3μ΄μ μ§€μ—° μ‹κ°„** λ°μƒ (ν„μ¬ sleepμ΄ λλ‚  λ•κΉμ§€)

**μ‹¤ν–‰ μμ„:**
1. `runFlag = false` μ„¤μ • β†’ μ¤λ λ“λ” μ—¬μ „ν `sleep(3000)` μ‹¤ν–‰ μ¤‘
2. 3μ΄ ν›„ `sleep` μ™„λ£ β†’ `while` μ΅°κ±΄ μ²΄ν¬ β†’ λ£¨ν”„ νƒμ¶

### 1.2 μΈν„°λ½νΈ κΈ°λ° μ¤‘λ‹¨μ μ¥μ 
```java
// Interrupt2.java μμ‹
try {
    while (true) {
        logger("μ‘μ—… μ¤‘");
        Thread.sleep(3000); // μΈν„°λ½νΈ κ°μ§€ κ°€λ¥ν• λ©”μ„λ“
    }
} catch (InterruptedException e) {
    // μ¦‰μ‹ μμ™Έ λ°μƒν•μ—¬ μ²λ¦¬
}
```

**μ¥μ : μ¦‰μ‹ μ¤‘λ‹¨λλ” μ΄μ **
- `Thread.interrupt()` νΈμ¶ μ‹ **λ€κΈ° μ¤‘μΈ μ¤λ λ“λ¥Ό μ¦‰μ‹ κΉ¨μ›€**
- `InterruptedException` λ°μƒμΌλ΅ **μ¦‰μ‹ μμ™Έ μ²λ¦¬ λΈ”λ΅μΌλ΅ μ΄λ™**
- **μ§€μ—° μ‹κ°„ μ—†μ΄ μ¦‰μ‹ λ°μ‘**

---

## 2. μΈν„°λ½νΈ λ™μ‘ λ©”μ»¤λ‹μ¦ μƒμ„Έ λ¶„μ„

### 2.1 μΈν„°λ½νΈ ν”λκ·Έμ™€ μƒνƒ λ³€ν™”

```java
Thread thread = new Thread(task, "work");
thread.start();
// μ¤λ λ“ μƒνƒ: RUNNABLE

thread.interrupt(); // μΈν„°λ½νΈ ν”λκ·Έ μ„¤μ •
// μ¤λ λ“ μƒνƒ: μ—¬μ „ν RUNNABLE (μ¦‰μ‹ μμ™Έ λ°μƒ X)
```

### 2.2 μΈν„°λ½νΈ μμ™Έκ°€ λ°μƒν•λ” μ‹μ 

**ν•µμ‹¬:** μΈν„°λ½νΈλ” **νΉμ • λ©”μ„λ“μ—μ„λ§** `InterruptedException`μ„ λ°μƒμ‹ν‚¨λ‹¤.

#### μΈν„°λ½νΈ μμ™Έλ¥Ό λμ§€λ” λ©”μ„λ“λ“¤:
- `Thread.sleep(long millis)`
- `Object.wait()`
- `Thread.join()`
- `BlockingQueue.take()`, `put()`
- `CountDownLatch.await()`
- `Semaphore.acquire()`

#### λ™μ‘ κ³Όμ •:
```java
// 1. μ¤λ λ“κ°€ while(true) λ£¨ν”„ μ‹¤ν–‰ μ¤‘ (RUNNABLE μƒνƒ)
while (true) {
    logger("μ‘μ—… μ¤‘");           // β† μ΄ μ‹μ μ— interrupt() νΈμ¶λμ–΄λ„ μμ™Έ X
    Thread.sleep(3000);        // β† μ΄ λ©”μ„λ“μ—μ„ InterruptedException λ°μƒ!
}
```

### 2.3 μΈν„°λ½νΈ μƒνƒ ν™•μΈ

```java
// μΈν„°λ½νΈ νΈμ¶ μ§ν›„
logger("work μ¤λ λ“ μΈν„°λ½νΈ μƒνƒ1 = " + thread.isInterrupted()); // true

// InterruptedException μ²λ¦¬ ν›„
logger("work μ¤λ λ“ μΈν„°λ½νΈ μƒνƒ2 = " + Thread.currentThread().isInterrupted()); // false
```

**μ¤‘μ”:** `InterruptedException` λ°μƒ μ‹ **μΈν„°λ½νΈ ν”λκ·Έκ°€ μλ™μΌλ΅ μ΄κΈ°ν™”**λ¨

---

## 3. μ‹¤ν–‰ μ‹λ‚λ¦¬μ¤ λ¶„μ„

### Scenario 1: λ³€μ κΈ°λ° μ¤‘λ‹¨
```
μ‹κ°„   μ¤λ λ“ μƒνƒ              λ™μ‘
0μ΄    RUNNABLE               μ‘μ—… μ‹μ‘
3μ΄    RUNNABLE               "μ‘μ—… μ¤‘" μ¶λ ¥ ν›„ sleep(3000) μ‹μ‘
4μ΄    TIMED_WAITING          mainμ—μ„ runFlag = false μ„¤μ •
6μ΄    RUNNABLE               sleep μ™„λ£, while μ΅°κ±΄ μ²΄ν¬, λ£¨ν”„ νƒμ¶
```
**μ§€μ—°μ‹κ°„: 2μ΄**

### Scenario 2: μΈν„°λ½νΈ κΈ°λ° μ¤‘λ‹¨
```
μ‹κ°„   μ¤λ λ“ μƒνƒ              λ™μ‘
0μ΄    RUNNABLE               μ‘μ—… μ‹μ‘  
3μ΄    TIMED_WAITING          "μ‘μ—… μ¤‘" μ¶λ ¥ ν›„ sleep(3000) μ‹μ‘
4μ΄    RUNNABLE               interrupt() β†’ InterruptedException μ¦‰μ‹ λ°μƒ
```
**μ§€μ—°μ‹κ°„: κ±°μ 0μ΄**

---

## 4. μΈν„°λ½νΈ μ²λ¦¬ λ¨λ²” μ‚¬λ΅€

### 4.1 κΈ°λ³Έ ν¨ν„΄
```java
try {
    while (!Thread.currentThread().isInterrupted()) {
        // μ‘μ—… μν–‰
        doSomeWork();
        Thread.sleep(1000); // μΈν„°λ½νΈ κ°μ§€ ν¬μΈνΈ
    }
} catch (InterruptedException e) {
    // μΈν„°λ½νΈ μƒνƒ λ³µμ› (ν•„μ”μ‹)
    Thread.currentThread().interrupt();
    
    // μ •λ¦¬ μ‘μ—…
    cleanup();
}
```

### 4.2 μΈν„°λ½νΈ λ¬΄μ‹ν•μ§€ μ•κΈ°
```java
// μλ»λ λ°©λ²• - μΈν„°λ½νΈ λ¬΄μ‹
catch (InterruptedException e) {
    // μ•„λ¬΄κ²ƒλ„ ν•μ§€ μ•μ - μ„ν—!
}

// μ¬λ°”λ¥Έ λ°©λ²• - μΈν„°λ½νΈ μƒνƒ λ³µμ›
catch (InterruptedException e) {
    Thread.currentThread().interrupt(); // μΈν„°λ½νΈ μƒνƒ λ³µμ›
    return; // λλ” μ μ ν• μΆ…λ£ μ²λ¦¬
}
```

---

## 5. isInterrupted() vs interrupted() μ°¨μ΄μ 

**π― ν•µμ‹¬**: `isInterrupted()`λ” μƒνƒλ§ ν™•μΈ, `interrupted()`λ” ν™•μΈν•κ³  μ¦‰μ‹ falseλ΅ λ¦¬μ…‹ν•λ‹¤.

### β λ¬Έμ  μƒν™©: isInterrupted() μ‚¬μ©

```java
public void problematicFileProcessor() {
    System.out.println("μΈν„°λ½νΈ μƒνƒ: " + Thread.currentThread().isInterrupted()); // false
    
    // λ‹¤λ¥Έ μ¤λ λ“μ—μ„ interrupt() νΈμ¶
    Thread.currentThread().interrupt(); // μΈν„°λ½νΈ μƒνƒ = true
    
    // 1λ‹¨κ³„: λ©”μΈ μ‘μ—… λ£¨ν”„
    while (!Thread.currentThread().isInterrupted()) { // β† μƒνƒλ§ ν™•μΈ (true)
        processFile();
    }
    // β†’ λ°λ³µλ¬Έ μΆ…λ£, ν•μ§€λ§ μΈν„°λ½νΈ μƒνƒλ” μ—¬μ „ν true!
    
    System.out.println("λ°λ³µλ¬Έ ν›„ μΈν„°λ½νΈ μƒνƒ: " + Thread.currentThread().isInterrupted()); // true
    
    // 2λ‹¨κ³„: μ •λ¦¬ μ‘μ—…
    try {
        cleanupResources(); // λ‚΄λ¶€μ— Thread.sleep(100) μλ‹¤λ©΄?
    } catch (InterruptedException e) {
        // π¨ μ–΄? μ—¬κΈ°μ„ λ μμ™Έκ°€?!
        System.out.println("μ •λ¦¬ μ¤‘ μμ™Έ λ°μƒ!"); 
    }
}
```

**νλ¦„**: μΈν„°λ½νΈ μƒνƒ true β†’ `isInterrupted()` ν™•μΈ β†’ λ°λ³µλ¬Έ μΆ…λ£ β†’ **μƒνƒ μ—¬μ „ν true** β†’ cleanupμ—μ„ λ μμ™Έ!

### β… ν•΄κ²°μ±…: interrupted() μ‚¬μ©

```java
public void fixedFileProcessor() {
    System.out.println("μΈν„°λ½νΈ μƒνƒ: " + Thread.currentThread().isInterrupted()); // false
    
    // λ‹¤λ¥Έ μ¤λ λ“μ—μ„ interrupt() νΈμ¶
    Thread.currentThread().interrupt(); // μΈν„°λ½νΈ μƒνƒ = true
    
    // 1λ‹¨κ³„: λ©”μΈ μ‘μ—… λ£¨ν”„
    while (!Thread.interrupted()) { // β† μƒνƒ ν™•μΈν•κ³  λ™μ‹μ— falseλ΅ λ¦¬μ…‹!
        processFile();
    }
    // β†’ λ°λ³µλ¬Έ μΆ…λ£, μΈν„°λ½νΈ μƒνƒλ” μ΄λ―Έ falseλ΅ λ³€κ²½λ¨
    
    System.out.println("λ°λ³µλ¬Έ ν›„ μΈν„°λ½νΈ μƒνƒ: " + Thread.currentThread().isInterrupted()); // false
    
    // 2λ‹¨κ³„: μ •λ¦¬ μ‘μ—…
    cleanupResources(); // λ” μ΄μƒ InterruptedException λ°μƒ μ•ν•¨!
    System.out.println("μ •λ¦¬ μ™„λ£!");
}
```

**νλ¦„**: μΈν„°λ½νΈ μƒνƒ true β†’ `interrupted()` ν™•μΈ + false λ¦¬μ…‹ β†’ λ°λ³µλ¬Έ μΆ…λ£ β†’ **μƒνƒλ” false** β†’ cleanup μ•μ „ μ‹¤ν–‰!

### π“ μ‹¤ν–‰ κ²°κ³Ό λΉ„κµ

```java
// isInterrupted() μ‚¬μ©μ‹
μΈν„°λ½νΈ μƒνƒ: false
λ°λ³µλ¬Έ ν›„ μΈν„°λ½νΈ μƒνƒ: true    β† λ¬Έμ !
μ •λ¦¬ μ¤‘ μμ™Έ λ°μƒ!

// interrupted() μ‚¬μ©μ‹  
μΈν„°λ½νΈ μƒνƒ: false
λ°λ³µλ¬Έ ν›„ μΈν„°λ½νΈ μƒνƒ: false   β† ν•΄κ²°!
μ •λ¦¬ μ™„λ£!
```

**β΅ μ£Όμμ‚¬ν•­**: μΈν„°λ½νΈ μ²λ¦¬ μ™„λ£ ν›„μ—λ” λ°λ“μ‹ μƒνƒλ¥Ό μ •μƒ(false)μΌλ΅ λλ ¤μ•Ό μ΄ν›„ μ½”λ“κ°€ μμƒλ€λ΅ λ™μ‘ν•¨. `interrupted()`λ” μ΄λ¥Ό μλ™μΌλ΅ ν•΄μ£Όλ” κ²ƒ!

---

## 6. Thread.yield()λ¥Ό μ΄μ©ν• CPU ν¨μ¨ κ°μ„ 

### 6.1 yield()μ κ°λ…
- μ¤λ λ“κ°€ λ°”μμ§€ μ•μ„ λ•, `Thread.yield()`λ¥Ό νΈμ¶ν•΄ CPU μ‹¤ν–‰ κΈ°νλ¥Ό λ‹¤λ¥Έ μ¤λ λ“μ— μ–‘λ³΄
- **μ¤μΌ€μ¤„λ¬μ—κ² ννΈ**λ¥Ό μ¤„ λΏ, λ°λ“μ‹ λ‹¤λ¥Έ μ¤λ λ“κ°€ μ‹¤ν–‰λλ‹¤λ” λ³΄μ¥μ€ μ—†μ
- CPU μ½”μ–΄ μκ°€ λ§μΌλ©΄ ν¨κ³Όκ°€ λ―Έλ―Έν•  μ μμ

### 6.2 sleep()κ³Ό yield()μ μ°¨μ΄μ 

| κµ¬λ¶„ | Thread.sleep() | Thread.yield() |
|------|---------------|---------------|
| **λ€κΈ° μ‹κ°„** | μ§€μ •ν• μ‹κ°„ λ™μ• μ™„μ „ν λ©μ¶¤ | μ κΉ μ‹¤ν–‰ λ€κΈ° μƒνƒλ΅ λ³€κ²½ |
| **μ¤λ λ“ μƒνƒ** | TIMED_WAITING | RUNNABLE β†’ RUNNABLE |
| **λ³΄μ¥** | μµμ† μ§€μ • μ‹κ°„μ€ λ€κΈ° | μ–‘λ³΄ ννΈλ§ μ κ³µ |
| **CPU μ‚¬μ©** | μ™„μ „ν μ–‘λ³΄ | λ‹¤λ¥Έ μ¤λ λ“μ— κΈ°ν μ κ³µ |

### 6.3 μ‹¤μ „ μ μ© μμ‹

#### ν”„λ¦°ν„° μ‘μ—… ν μμ 
```java
public class PrinterManager {
    private Queue<PrintJob> jobQueue = new LinkedList<>();
    
    public void processPrintJobs() {
        while (true) {
            if (jobQueue.isEmpty()) {
                // μ‘μ—…μ΄ μ—†μ„ λ• CPU μ–‘λ³΄
                Thread.yield(); // β† λ¶ν•„μ”ν• λ°λ³µλ¬Έ μ‹¤ν–‰ μ¤„μ„
                continue;
            }
            
            PrintJob job = jobQueue.poll();
            processJob(job);
        }
    }
}
```

#### 1000κ° μ¤λ λ“ μ‹¤ν–‰ μμ 
```java
// yield() μ—†μ΄ μ‹¤ν–‰
for (int i = 0; i < 1000; i++) {
    new Thread(() -> {
        for (int j = 0; j < 10; j++) {
            System.out.print(j + " ");
        }
    }).start();
}
// κ²°κ³Ό: ν• μ¤λ λ“κ°€ μ—°μ†μΌλ΅ λ§μ΄ μ‹¤ν–‰λ  κ°€λ¥μ„± λ†’μ

// yield() μ‚¬μ©ν•μ—¬ μ‹¤ν–‰
for (int i = 0; i < 1000; i++) {
    new Thread(() -> {
        for (int j = 0; j < 10; j++) {
            System.out.print(j + " ");
            Thread.yield(); // β† λ‹¤λ¥Έ μ¤λ λ“μ— κΈ°ν μ κ³µ
        }
    }).start();
}
// κ²°κ³Ό: μ—¬λ¬ μ¤λ λ“κ°€ λ²κ°μ•„ κ°€λ©΄μ„ μ‹¤ν–‰λ¨
```

### 6.4 yield() μ‚¬μ© κ°€μ΄λ“λΌμΈ

**β… μ μ ν• μ‚¬μ© μ‹κΈ°:**
- μ‘μ—… νκ°€ λΉ„μ–΄μμ„ λ•
- λ¬΄ν• λ£¨ν”„μ—μ„ μ΅°κ±΄ μ²΄ν¬ μ‹
- CPU μ§‘μ•½μ  μ‘μ—… μ‚¬μ΄μ‚¬μ΄

**β λ¶€μ μ ν• μ‚¬μ©:**
- μ„±λ¥μ΄ μ¤‘μ”ν• μ½”λ“μ—μ„ λ‚¨μ©
- μ •ν™•ν• νƒ€μ΄λ°μ΄ ν•„μ”ν• κ²½μ°
- μ΄λ―Έ μ¶©λ¶„ν• λ€κΈ°κ°€ μλ” μ½”λ“

```java
// μΆ‹μ€ μμ‹
while (condition) {
    if (noWorkToDo()) {
        Thread.yield(); // CPU μ–‘λ³΄
        continue;
    }
    doWork();
}

// λ‚μ μμ‹
for (int i = 0; i < 1000000; i++) {
    Thread.yield(); // μ„±λ¥ μ €ν•!
    calculation(i);
}
```

---

## 7. μ”μ•½

| κµ¬λ¶„ | λ³€μ κΈ°λ° μ¤‘λ‹¨ | μΈν„°λ½νΈ κΈ°λ° μ¤‘λ‹¨ | yield() ν™μ© |
|------|-------------|-----------------|-------------|
| **λ°μ‘ μ†λ„** | μ§€μ—°λ¨ (λ€κΈ° μ‘μ—… μ™„λ£κΉμ§€) | μ¦‰μ‹ | ννΈ μμ¤€ |
| **κµ¬ν„ λ³µμ΅λ„** | λ‹¨μ | μ¤‘κ°„ | λ§¤μ° λ‹¨μ |
| **κ¶μ¥ μ‚¬μ©** | κ°„λ‹¨ν• λ£¨ν”„ | λ€κΈ°κ°€ ν¬ν•¨λ μ‘μ—… | CPU ν¨μ¨ κ°μ„  |
| **μ•μ „μ„±** | λ†’μ | μ¤‘κ°„ (μƒνƒ κ΄€λ¦¬ ν•„μ”) | λ†’μ |

**κ²°λ΅ :** 
- **μ¦‰μ‹ λ°μ‘**μ΄ ν•„μ”ν• κ²½μ°: **μΈν„°λ½νΈ + interrupted() μ‚¬μ©**
- **λ‹¨μν• ν”λκ·Έ κΈ°λ°** μ¤‘λ‹¨μΌλ΅ μ¶©λ¶„ν• κ²½μ°: **λ³€μ μ‚¬μ©**
- **CPU ν¨μ¨**μ„ λ†’μ΄κ³  μ‹¶μ€ κ²½μ°: **yield() μ¶”κ°€ ν™μ©**
- λ‘ λ°©λ²•μ„ **μ΅°ν•©**ν•μ—¬ μ‚¬μ©ν•λ” κ²ƒμ΄ κ°€μ¥ μ•μ „ν•κ³  ν¨κ³Όμ 