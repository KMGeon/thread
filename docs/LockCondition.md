# LockConditionê³¼ BlockingQueue ì™„ì „ ì •ë¦¬

## ê°œìš”
- wait-notify ë©”ì»¤ë‹ˆì¦˜ì˜ ê·¼ë³¸ì ì¸ í•œê³„ë¥¼ ReentrantLock + Conditionìœ¼ë¡œ í•´ê²°
- ìƒì‚°ìì™€ ì†Œë¹„ìì˜ ëŒ€ê¸° ê³µê°„ì„ ë¶„ë¦¬í•˜ì—¬ ì •í™•í•œ ìŠ¤ë ˆë“œë§Œ ê¹¨ìš°ê¸°
- BlockingQueueë¥¼ í†µí•œ ì‹¤ìš©ì ì¸ ìƒì‚°ì-ì†Œë¹„ì íŒ¨í„´ êµ¬í˜„

> ReentrantLock + Conditionì€ synchronized + wait/notifyì˜ ëª¨ë“  ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ” í˜„ëŒ€ì  ë™ê¸°í™” ë©”ì»¤ë‹ˆì¦˜ì…ë‹ˆë‹¤.

## synchronized + wait/notify ë¬¸ì œì  ì¬ì •ë¦¬

### í•µì‹¬ ë¬¸ì œ: í•˜ë‚˜ì˜ ëŒ€ê¸° ì§‘í•© (Wait Set)

```
ğŸ“ ë¬¸ì œ ìƒí™© ì‹œê°í™”

          í•˜ë‚˜ì˜ ëŒ€ê¸° ì§‘í•© (Wait Set)
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  ğŸ˜´ Producer1  ğŸ˜´ Consumer1  ğŸ˜´ Producer2  â”‚
    â”‚  ğŸ˜´ Consumer2  ğŸ˜´ Consumer3  ğŸ˜´ Producer3  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
                  notify() í˜¸ì¶œ
                         â†“
            ğŸ² ë¬´ì‘ìœ„ë¡œ í•˜ë‚˜ë§Œ ì„ íƒ!
                         â†“
        âŒ Consumerê°€ Consumerë¥¼ ê¹¨ìš°ëŠ” ë¹„íš¨ìœ¨!
```

### êµ¬ì²´ì ì¸ ë¬¸ì œ ì‹œë‚˜ë¦¬ì˜¤
```java
// ìƒí™©: íê°€ ë¹„ì–´ìˆìŒ, ì†Œë¹„ìë“¤ë§Œ ëŒ€ê¸° ì¤‘
// ëŒ€ê¸°ì§‘í•©: [Consumer1, Consumer2, Consumer3, Producer1]

// Consumer1ì´ ì‘ì—… ì™„ë£Œ í›„ notify() í˜¸ì¶œ
consumer1.notify(); // ğŸ² ëœë¤í•˜ê²Œ Consumer2ë¥¼ ê¹¨ì›€!

// Consumer2 ê¹¨ì–´ë‚¨
consumer2: "íë¥¼ í™•ì¸í•´ë³´ë‹ˆ... ì—¬ì „íˆ ë¹„ì–´ìˆë„¤? ë‹¤ì‹œ ëŒ€ê¸°..."
consumer2.wait(); // ğŸ˜´ ë‹¤ì‹œ ì ë“¦

// ê²°ê³¼: ì˜ë¯¸ì—†ëŠ” ì‘ì—…, Producer1ì€ ì—¬ì „íˆ ëŒ€ê¸° ì¤‘
```

## ReentrantLock + Condition í•´ê²°ì±…

### í•µì‹¬ ì•„ì´ë””ì–´: ëŒ€ê¸° ê³µê°„ ë¶„ë¦¬

![img.png](../img/img10.png)

```
ğŸ¯ í•´ê²°ì±… ì‹œê°í™”: ë¶„ë¦¬ëœ ëŒ€ê¸° ê³µê°„

     Producer ì „ìš© ëŒ€ê¸° ê³µê°„        Consumer ì „ìš© ëŒ€ê¸° ê³µê°„
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  ğŸ˜´ Producer1          â”‚    â”‚  ğŸ˜´ Consumer1          â”‚
   â”‚  ğŸ˜´ Producer2          â”‚    â”‚  ğŸ˜´ Consumer2          â”‚
   â”‚  ğŸ˜´ Producer3          â”‚    â”‚  ğŸ˜´ Consumer3          â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†‘                              â†‘
    producerCond.await()           consumerCond.await()
            â†‘                              â†‘
   producerCond.signal()           consumerCond.signal()
            â†‘                              â†‘
      ì†Œë¹„ìê°€ í˜¸ì¶œ                   ìƒì‚°ìê°€ í˜¸ì¶œ
```

### BoundedQueue ReentrantLock êµ¬í˜„

```java
public class BoundedQueueV5<T> {
    private final Queue<T> queue = new ArrayDeque<>();
    private final int max;
    
    // ğŸ”§ í•µì‹¬: ReentrantLockê³¼ ë¶„ë¦¬ëœ Condition
    private final Lock lock = new ReentrantLock();
    private final Condition producerCond = lock.newCondition();  // ìƒì‚°ì ì „ìš©
    private final Condition consumerCond = lock.newCondition();  // ì†Œë¹„ì ì „ìš©
    
    // ìƒì‚°ì ë©”ì„œë“œ
    public void put(T data) throws InterruptedException {
        lock.lock();
        try {
            while (queue.size() == max) {
                log("íê°€ ê°€ë“ì°¸, ìƒì‚°ì ëŒ€ê¸°");
                producerCond.await(); // ğŸ¯ ìƒì‚°ì ì „ìš© ëŒ€ê¸° ê³µê°„
            }
            queue.offer(data);
            log("ìƒì‚°ì™„ë£Œ: " + data);
            consumerCond.signal(); // ğŸ¯ ì†Œë¹„ìë§Œ ê¹¨ìš°ê¸°!
        } finally {
            lock.unlock();
        }
    }
    
    // ì†Œë¹„ì ë©”ì„œë“œ  
    public T take() throws InterruptedException {
        lock.lock();
        try {
            while (queue.isEmpty()) {
                log("íê°€ ë¹„ì–´ìˆìŒ, ì†Œë¹„ì ëŒ€ê¸°");
                consumerCond.await(); // ğŸ¯ ì†Œë¹„ì ì „ìš© ëŒ€ê¸° ê³µê°„
            }
            T data = queue.poll();
            log("ì†Œë¹„ì™„ë£Œ: " + data);
            producerCond.signal(); // ğŸ¯ ìƒì‚°ìë§Œ ê¹¨ìš°ê¸°!
            return data;
        } finally {
            lock.unlock();
        }
    }
}
```

### ê°œì„ ëœ ë™ì‘ ê³¼ì •

```
âœ… ì •í™•í•œ ìŠ¤ë ˆë“œ ê¹¨ìš°ê¸° ì‹œë‚˜ë¦¬ì˜¤

T=0: íê°€ ë¹„ì–´ìˆìŒ
     Producer1, Producer2ëŠ” producerCondì—ì„œ ëŒ€ê¸°
     Consumer1, Consumer2ëŠ” consumerCondì—ì„œ ëŒ€ê¸°
     
     producerCond ëŒ€ê¸°: [Producer1, Producer2]
     consumerCond ëŒ€ê¸°: [Consumer1, Consumer2]

T=1: Producer3ê°€ ë°ì´í„° ìƒì‚°
     consumerCond.signal() í˜¸ì¶œ
     â†’ Consumer1ë§Œ ê¹¨ì–´ë‚¨! âœ…
     â†’ Producerë“¤ì€ ê³„ì† ëŒ€ê¸° (ì •í™•í•¨!)
     
T=2: Consumer1ì´ ë°ì´í„° ì†Œë¹„  
     producerCond.signal() í˜¸ì¶œ
     â†’ Producer1ë§Œ ê¹¨ì–´ë‚¨! âœ…
     â†’ ë‹¤ë¥¸ Consumerë“¤ì€ ê³„ì† ëŒ€ê¸° (ì •í™•í•¨!)

ğŸ‰ ê²°ê³¼: í•­ìƒ ì˜¬ë°”ë¥¸ íƒ€ì…ì˜ ìŠ¤ë ˆë“œë§Œ ê¹¨ì–´ë‚¨!
```

## ë½ ëŒ€ê¸°ì§‘í•© ìš©ì–´ ì •ë¦¬

### synchronized í™˜ê²½

```
ğŸ¢ synchronized ë¹Œë”© êµ¬ì¡°

          synchronized ë©”ì„œë“œ/ë¸”ë¡
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                           â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
    â”‚ Entry   â”‚                â”‚ Wait Set  â”‚
    â”‚ Set     â”‚   wait()       â”‚           â”‚
    â”‚         â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚           â”‚
    â”‚ BLOCKED â”‚                â”‚ WAITING   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   notify()
```

**Entry Set (ì—”íŠ¸ë¦¬ ì…‹)**
- synchronized ë¸”ë¡ ì§„ì…ì„ ê¸°ë‹¤ë¦¬ëŠ” ìŠ¤ë ˆë“œë“¤
- ìŠ¤ë ˆë“œ ìƒíƒœ: `BLOCKED`
- ë½ì´ í•´ì œë˜ë©´ ìë™ìœ¼ë¡œ ê²½ìŸí•˜ì—¬ í•˜ë‚˜ê°€ ë½ íšë“

**Wait Set (ëŒ€ê¸° ì…‹)**
- `wait()` ë©”ì„œë“œë¡œ ì¡°ê±´ì„ ê¸°ë‹¤ë¦¬ëŠ” ìŠ¤ë ˆë“œë“¤
- ìŠ¤ë ˆë“œ ìƒíƒœ: `WAITING` ë˜ëŠ” `TIMED_WAITING`
- `notify()` ë˜ëŠ” `notifyAll()`ë¡œë§Œ ê¹¨ì–´ë‚¨

### ReentrantLock í™˜ê²½

```
ğŸ¢ ReentrantLock ë¹Œë”© êµ¬ì¡°

    ReentrantLock ëŒ€ê¸° í        Condition ëŒ€ê¸° ê³µê°„ë“¤
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚      WAITING        â”‚    â”‚ producerCond:       â”‚
   â”‚   (ë½ ëŒ€ê¸° ì¤‘)       â”‚    â”‚   WAITING           â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚                     â”‚
            â†•                â”‚ consumerCond:       â”‚
      lock()/unlock()         â”‚   WAITING           â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â†•
                               await()/signal()
```

**ReentrantLock ëŒ€ê¸° í**
- `lock()` í˜¸ì¶œ ì‹œ ë½ì´ ì‚¬ìš© ì¤‘ì´ë©´ ëŒ€ê¸°
- ìŠ¤ë ˆë“œ ìƒíƒœ: `WAITING`
- ë½ í•´ì œ ì‹œ FIFO ìˆœì„œë¡œ ê¹¨ì–´ë‚¨

**Condition ëŒ€ê¸° ê³µê°„**
- `await()` í˜¸ì¶œí•œ ìŠ¤ë ˆë“œë“¤ì´ ëŒ€ê¸°
- ìŠ¤ë ˆë“œ ìƒíƒœ: `WAITING` ë˜ëŠ” `TIMED_WAITING`
- `signal()` ë˜ëŠ” `signalAll()`ë¡œ ê¹¨ì–´ë‚¨

## Conditionì˜ ì¥ì 

### 1. ì •í™•ì„± (Correctness)
```java
// âœ… ReentrantLock + Condition
consumerCond.signal(); // í•­ìƒ Consumerë§Œ ê¹¨ì›€
producerCond.signal(); // í•­ìƒ Producerë§Œ ê¹¨ì›€

// âŒ synchronized + notify  
notify(); // ğŸ² ë¬´ì‘ìœ„ë¡œ ì•„ë¬´ë‚˜ ê¹¨ì›€
```

### 2. íš¨ìœ¨ì„± (Efficiency)
```
ğŸ“Š ì„±ëŠ¥ ë¹„êµ

synchronized + notify():
- ì˜ëª»ëœ ìŠ¤ë ˆë“œ ê¹¨ì–´ë‚¨: 50% í™•ë¥ 
- ë¶ˆí•„ìš”í•œ ì»¨í…ìŠ¤íŠ¸ ìŠ¤ìœ„ì¹­: ë†’ìŒ
- CPU ë‚­ë¹„: ìƒë‹¹í•¨

ReentrantLock + signal():
- ì˜ëª»ëœ ìŠ¤ë ˆë“œ ê¹¨ì–´ë‚¨: 0%
- ë¶ˆí•„ìš”í•œ ì»¨í…ìŠ¤íŠ¸ ìŠ¤ìœ„ì¹­: ì—†ìŒ  
- CPU íš¨ìœ¨: ìµœì 
```

### 3. ìœ ì—°ì„± (Flexibility)
```java
// ì—¬ëŸ¬ ì¡°ê±´ë³„ë¡œ ëŒ€ê¸° ê³µê°„ ë¶„ë¦¬ ê°€ëŠ¥
private final Condition notFull = lock.newCondition();
private final Condition notEmpty = lock.newCondition();
private final Condition priority = lock.newCondition();

// ì„¸ë°€í•œ ì œì–´
if (priority > 5) {
    priority.signal();
} else {
    notEmpty.signal();
}
```

## BlockingQueue: ì™„ì„±ëœ í•´ê²°ì±…

### BlockingQueue ì†Œê°œ

```
ğŸ BlockingQueue = ReentrantLock + Condition + Queueì˜ ì™„ì „ì²´

   ì‚¬ìš©ì ì½”ë“œ                    BlockingQueue ë‚´ë¶€
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ queue.put(data) â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚ lock.lock()                 â”‚
â”‚                 â”‚           â”‚ while(queue.isFull())       â”‚
â”‚                 â”‚           â”‚   notFull.await()           â”‚
â”‚                 â”‚           â”‚ queue.add(data)             â”‚
â”‚                 â”‚           â”‚ notEmpty.signal()           â”‚
â”‚                 â”‚           â”‚ lock.unlock()               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### íŠ¹ì§•
- ìŠ¤ë ˆë“œë¥¼ **ì°¨ë‹¨(blocking)** í•  ìˆ˜ ìˆëŠ” í
- **ë°ì´í„° ì¶”ê°€ ì°¨ë‹¨**: íê°€ ê°€ë“ ì°¨ë©´ ê³µê°„ì´ ìƒê¸¸ ë•Œê¹Œì§€ ëŒ€ê¸°
- **ë°ì´í„° íšë“ ì°¨ë‹¨**: íê°€ ë¹„ì–´ìˆìœ¼ë©´ ë°ì´í„°ê°€ ë“¤ì–´ì˜¬ ë•Œê¹Œì§€ ëŒ€ê¸°
- ë‚´ë¶€ì ìœ¼ë¡œ ReentrantLock + Conditionìœ¼ë¡œ êµ¬í˜„

### ì£¼ìš” êµ¬í˜„ì²´

```java
// ğŸ—ï¸ ë°°ì—´ ê¸°ë°˜ - í¬ê¸° ê³ ì •
ArrayBlockingQueue<String> arrayQueue = new ArrayBlockingQueue<>(10);

// ğŸ”— ë§í¬ ê¸°ë°˜ - í¬ê¸° ì„ íƒ ê°€ëŠ¥
LinkedBlockingQueue<String> linkedQueue = new LinkedBlockingQueue<>(); // ë¬´í•œ
LinkedBlockingQueue<String> boundedLinked = new LinkedBlockingQueue<>(100); // ì œí•œ
```

## BlockingQueue ë©”ì„œë“œ ì „ëµ

### 4ê°€ì§€ ì²˜ë¦¬ ì „ëµ

```
ğŸ“‹ BlockingQueue ë©”ì„œë“œ ë§¤íŠ¸ë¦­ìŠ¤

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•¦â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘   Operation  â•‘ Throws        â•‘ Special      â•‘  Blocks   â•‘    Times Out     â•‘
â•‘              â•‘ Exception     â•‘ Value        â•‘           â•‘                  â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ Insert(ì¶”ê°€) â•‘   add(e)      â•‘  offer(e)    â•‘  put(e)   â•‘ offer(e,time,u)  â•‘
â•‘              â•‘ ğŸ”¥ Exception  â•‘ ğŸ”„ false     â•‘ â³ ëŒ€ê¸°   â•‘ â° ì‹œê°„ì œí•œ ëŒ€ê¸°   â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ Remove(ì œê±°) â•‘  remove()     â•‘   poll()     â•‘  take()   â•‘ poll(time,unit)  â•‘
â•‘              â•‘ ğŸ”¥ Exception  â•‘ ğŸ”„ null      â•‘ â³ ëŒ€ê¸°   â•‘ â° ì‹œê°„ì œí•œ ëŒ€ê¸°   â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•¬â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘Examine(í™•ì¸) â•‘  element()    â•‘   peek()     â•‘ í•´ë‹¹ ì—†ìŒ  â•‘    í•´ë‹¹ ì—†ìŒ      â•‘
â•‘              â•‘ ğŸ”¥ Exception  â•‘ ğŸ”„ null      â•‘           â•‘                  â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•©â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### ì „ëµë³„ ìƒì„¸ ì„¤ëª…

#### 1. Throws Exception ì „ëµ
```java
// ğŸ”¥ ì˜ˆì™¸ ë°œìƒ ë°©ì‹ - ì¦‰ì‹œ ì‹¤íŒ¨
try {
    queue.add("data");        // í ê°€ë“ì°¸ â†’ IllegalStateException
    String data = queue.remove(); // í ë¹„ì–´ìˆìŒ â†’ NoSuchElementException
} catch (Exception e) {
    log("í ìƒíƒœ ë¬¸ì œ: " + e.getMessage());
}
```

#### 2. Special Value ì „ëµ
```java
// ğŸ”„ íŠ¹ë³„ê°’ ë°˜í™˜ ë°©ì‹ - ìƒíƒœ í™•ì¸ ê°€ëŠ¥
boolean success = queue.offer("data"); // ê°€ë“ì°¸ â†’ false
String data = queue.poll();            // ë¹„ì–´ìˆìŒ â†’ null

if (success) {
    log("ë°ì´í„° ì¶”ê°€ ì„±ê³µ");
} else {
    log("íê°€ ê°€ë“ì°¸");
}
```

#### 3. Blocks ì „ëµ
```java
// â³ ëŒ€ê¸° ë°©ì‹ - ì¡°ê±´ ë§Œì¡±ê¹Œì§€ ë¬´í•œ ëŒ€ê¸°
try {
    queue.put("data");    // ê³µê°„ ìƒê¸¸ ë•Œê¹Œì§€ ëŒ€ê¸°
    String data = queue.take(); // ë°ì´í„° ë“¤ì–´ì˜¬ ë•Œê¹Œì§€ ëŒ€ê¸°
} catch (InterruptedException e) {
    log("ëŒ€ê¸° ì¤‘ ì¸í„°ëŸ½íŠ¸ ë°œìƒ");
}
```

#### 4. Times Out ì „ëµ
```java
// â° ì‹œê°„ì œí•œ ëŒ€ê¸° ë°©ì‹
try {
    boolean success = queue.offer("data", 1, TimeUnit.SECONDS);
    String data = queue.poll(2, TimeUnit.SECONDS);
    
    if (success) {
        log("1ì´ˆ ë‚´ ì¶”ê°€ ì„±ê³µ");
    } else {
        log("1ì´ˆ ëŒ€ê¸° í›„ í¬ê¸°");
    }
} catch (InterruptedException e) {
    log("ëŒ€ê¸° ì¤‘ ì¸í„°ëŸ½íŠ¸");
}
```

## BlockingQueue êµ¬í˜„ ì˜ˆì œ ë¹„êµ

### BoundedQueueV6_1: ì™„ì „ ëŒ€ê¸° ë°©ì‹

```java
public class BoundedQueueV6_1<T> implements BoundedQueue<T> {
    private final BlockingQueue<T> queue;
    
    public BoundedQueueV6_1(int max) {
        this.queue = new ArrayBlockingQueue<>(max);
    }
    
    @Override
    public void put(T data) {
        try {
            queue.put(data); // â³ ë¬´í•œ ëŒ€ê¸°
            log("[" + Thread.currentThread().getName() + "] ì €ì¥: " + data);
        } catch (InterruptedException e) {
            throw new RuntimeException(e);
        }
    }
    
    @Override
    public T take() {
        try {
            T data = queue.take(); // â³ ë¬´í•œ ëŒ€ê¸°
            log("[" + Thread.currentThread().getName() + "] íšë“: " + data);
            return data;
        } catch (InterruptedException e) {
            throw new RuntimeException(e);
        }
    }
}
```

### BoundedQueueV6_2: ì¦‰ì‹œ ë°˜í™˜ ë°©ì‹

```java
public class BoundedQueueV6_2<T> implements BoundedQueue<T> {
    private final BlockingQueue<T> queue;
    
    public BoundedQueueV6_2(int max) {
        this.queue = new ArrayBlockingQueue<>(max);
    }
    
    @Override
    public void put(T data) {
        boolean result = queue.offer(data); // ğŸ”„ ì¦‰ì‹œ ë°˜í™˜
        if (result) {
            log("[" + Thread.currentThread().getName() + "] ì €ì¥ ì„±ê³µ: " + data);
        } else {
            log("[" + Thread.currentThread().getName() + "] ì €ì¥ ì‹¤íŒ¨: í ê°€ë“ì°¸");
        }
    }
    
    @Override
    public T take() {
        T data = queue.poll(); // ğŸ”„ ì¦‰ì‹œ ë°˜í™˜
        if (data != null) {
            log("[" + Thread.currentThread().getName() + "] íšë“ ì„±ê³µ: " + data);
        } else {
            log("[" + Thread.currentThread().getName() + "] íšë“ ì‹¤íŒ¨: í ë¹„ì–´ìˆìŒ");
        }
        return data;
    }
}
```

### BoundedQueueV6_3: ì‹œê°„ ì œí•œ ë°©ì‹

```java
public class BoundedQueueV6_3<T> implements BoundedQueue<T> {
    private final BlockingQueue<T> queue;
    
    public BoundedQueueV6_3(int max) {
        this.queue = new ArrayBlockingQueue<>(max);
    }
    
    @Override
    public void put(T data) {
        try {
            // â° 1ë‚˜ë…¸ì´ˆë§Œ ëŒ€ê¸° (ê±°ì˜ ì¦‰ì‹œ í¬ê¸°)
            boolean result = queue.offer(data, 1, TimeUnit.NANOSECONDS);
            if (result) {
                log("ì €ì¥ ì„±ê³µ: " + data);
            } else {
                log("ì €ì¥ ì‹¤íŒ¨: ì‹œê°„ ì´ˆê³¼");
            }
        } catch (InterruptedException e) {
            throw new RuntimeException(e);
        }
    }
    
    @Override
    public T take() {
        try {
            // â° 2ì´ˆ ëŒ€ê¸°
            T data = queue.poll(2, TimeUnit.SECONDS);
            if (data != null) {
                log("íšë“ ì„±ê³µ: " + data);
            } else {
                log("íšë“ ì‹¤íŒ¨: 2ì´ˆ ì‹œê°„ ì´ˆê³¼");
            }
            return data;
        } catch (InterruptedException e) {
            throw new RuntimeException(e);
        }
    }
}
```

## ì‹¤í–‰ ê²°ê³¼ ë¹„êµ

### ì™„ì „ ëŒ€ê¸° ë°©ì‹ (V6_1)
```
ğŸ• ì‹¤í–‰ ë¡œê·¸
[producer1] ì €ì¥: data1
[producer1] ì €ì¥: data2  
[producer1] ì €ì¥ ëŒ€ê¸°... (í ê°€ë“ì°¸)
[consumer1] íšë“: data1
[producer1] ì €ì¥: data3  (ëŒ€ê¸° í•´ì œ)
[consumer1] íšë“: data2
```

### ì¦‰ì‹œ ë°˜í™˜ ë°©ì‹ (V6_2)
```
ğŸ• ì‹¤í–‰ ë¡œê·¸
[producer1] ì €ì¥ ì„±ê³µ: data1
[producer1] ì €ì¥ ì„±ê³µ: data2
[producer1] ì €ì¥ ì‹¤íŒ¨: í ê°€ë“ì°¸
[consumer1] íšë“ ì„±ê³µ: data1
[consumer1] íšë“ ì„±ê³µ: data2
[consumer1] íšë“ ì‹¤íŒ¨: í ë¹„ì–´ìˆìŒ
```

### ì‹œê°„ ì œí•œ ë°©ì‹ (V6_3)
```
ğŸ• ì‹¤í–‰ ë¡œê·¸
[producer1] ì €ì¥ ì„±ê³µ: data1
[producer1] ì €ì¥ ì„±ê³µ: data2
[producer1] ì €ì¥ ì‹¤íŒ¨: ì‹œê°„ ì´ˆê³¼
[consumer1] íšë“ ì„±ê³µ: data1
[consumer1] íšë“ ì„±ê³µ: data2
[consumer1] íšë“ ì‹¤íŒ¨: 2ì´ˆ ì‹œê°„ ì´ˆê³¼
```

## Doug Leaì˜ ê¸°ì—¬

```
ğŸ‘¨â€ğŸ’» Doug Lea: java.util.concurrentì˜ ì•„ë²„ì§€

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  ì£¼ìš” ê¸°ì—¬ ì‚¬í•­                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ JSR-166 ì£¼ë„ (Java Concurrency Utilities)            â”‚
â”‚ â€¢ ReentrantLock, Condition ì„¤ê³„ ë° êµ¬í˜„                â”‚
â”‚ â€¢ BlockingQueue ì¸í„°í˜ì´ìŠ¤ ë° êµ¬í˜„ì²´ë“¤ ì„¤ê³„              â”‚
â”‚ â€¢ ThreadPoolExecutor, CountDownLatch ë“± ê³ ê¸‰ ë„êµ¬       â”‚
â”‚ â€¢ Fork/Join Framework ì„¤ê³„ (Java 7)                   â”‚
â”‚ â€¢ StampedLock ì„¤ê³„ (Java 8)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ¯ í•µì‹¬ ì² í•™:
"ë³µì¡í•œ ë™ì‹œì„± ë¬¸ì œë¥¼ ê°„ë‹¨í•˜ê³  ì•ˆì „í•˜ê²Œ í•´ê²°í•  ìˆ˜ ìˆëŠ” ë„êµ¬ ì œê³µ"
```

**ì£¼ìš” ì„±ê³¼:**
- **ì•ˆì „ì„±**: ë°ë“œë½, ë ˆì´ìŠ¤ ì»¨ë””ì…˜ ë“±ì˜ ë™ì‹œì„± ë²„ê·¸ ë°©ì§€
- **ì„±ëŠ¥**: ê³ ë„ë¡œ ìµœì í™”ëœ ë¹„ì°¨ë‹¨(non-blocking) ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„
- **ì‚¬ìš©ì„±**: ì§ê´€ì ì´ê³  ì¼ê´€ì„± ìˆëŠ” API ì„¤ê³„
- **ê²€ì¦**: ìˆ˜ë…„ê°„ì˜ ì‹¤ì „ ì‚¬ìš©ê³¼ í•™ìˆ ì  ê²€ì¦ì„ í†µí•œ ì•ˆì •ì„± í™•ë³´

## ìŠ¤ë ˆë“œ ìƒíƒœ ë¹„êµ ì •ë¦¬

### synchronized vs ReentrantLock

```
ğŸ“Š ìŠ¤ë ˆë“œ ìƒíƒœ ë§¤í•‘ ë¹„êµ

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    synchronized í™˜ê²½                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ë½ íšë“ ëŒ€ê¸°        â”‚ Entry Set â†’ BLOCKED ìƒíƒœ                â”‚
â”‚ ì¡°ê±´ ëŒ€ê¸°          â”‚ Wait Set â†’ WAITING/TIMED_WAITING ìƒíƒœ   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  ReentrantLock í™˜ê²½                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ë½ íšë“ ëŒ€ê¸°        â”‚ ReentrantLock Queue â†’ WAITING ìƒíƒœ      â”‚
â”‚ ì¡°ê±´ ëŒ€ê¸°          â”‚ Condition Queue â†’ WAITING/TIMED_WAITING â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**í•µì‹¬ ì°¨ì´ì :**
1. **ëŒ€ê¸° ê³µê°„**: synchronized(1ê°œ) vs ReentrantLock(Nê°œ)
2. **ì„ íƒì  ê¹¨ìš°ê¸°**: notify(ë¬´ì‘ìœ„) vs signal(ì •í™•)
3. **ìƒíƒœ ê´€ë¦¬**: BLOCKED vs WAITING (ë” ì¼ê´€ì„± ìˆìŒ)
4. **ê³µì •ì„±**: ê¸°ë³¸ì ìœ¼ë¡œ ë¶ˆê³µì • vs ê³µì •/ë¶ˆê³µì • ì„ íƒ ê°€ëŠ¥

## ì‹¤ë¬´ ê¶Œì¥ì‚¬í•­

### ì„ íƒ ê°€ì´ë“œë¼ì¸

```
ğŸ¯ ì–¸ì œ ë¬´ì—‡ì„ ì‚¬ìš©í• ê¹Œ?

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     ìƒí™©            â”‚                ê¶Œì¥ ì‚¬í•­                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ê°„ë‹¨í•œ ë™ê¸°í™”       â”‚ synchronized (ê°„ë‹¨í•¨)                   â”‚
â”‚ ë³µì¡í•œ ì¡°ê±´ ëŒ€ê¸°    â”‚ ReentrantLock + Condition (ì •í™•ì„±)      â”‚
â”‚ ìƒì‚°ì-ì†Œë¹„ì íŒ¨í„´  â”‚ BlockingQueue (ê²€ì¦ëœ ì†”ë£¨ì…˜)           â”‚
â”‚ ê³ ì„±ëŠ¥ ìš”êµ¬ì‚¬í•­     â”‚ Lock-free ìë£Œêµ¬ì¡° (ConcurrentHashMap)  â”‚
â”‚ í•™ìŠµ ëª©ì           â”‚ ì§ì ‘ êµ¬í˜„ â†’ BlockingQueue ìˆœì„œ          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ìµœì¢… ê¶Œì¥ì‚¬í•­

1. **í•™ìŠµ ë‹¨ê³„**: synchronized â†’ ReentrantLock â†’ BlockingQueue ìˆœì„œë¡œ ì´í•´
2. **ì‹¤ë¬´ ë‹¨ê³„**: ê²€ì¦ëœ `java.util.concurrent` íŒ¨í‚¤ì§€ ì ê·¹ í™œìš©
3. **ì„±ëŠ¥ ìµœì í™”**: í”„ë¡œíŒŒì¼ë§ í›„ í•„ìš”ì‹œì—ë§Œ ê³ ê¸‰ ê¸°ë²• ì ìš©
4. **ì½”ë“œ ë¦¬ë·°**: ë™ì‹œì„± ì½”ë“œëŠ” ë°˜ë“œì‹œ ë™ë£Œ ê²€í†  í•„ìˆ˜

```
ğŸ’¡ í•µì‹¬ ë©”ì‹œì§€

"ë°”í€´ë¥¼ ë‹¤ì‹œ ë°œëª…í•˜ì§€ ë§ˆì„¸ìš”.
 Doug Leaê°€ ì´ë¯¸ ì™„ë²½í•˜ê²Œ ë§Œë“¤ì–´ ë†“ì•˜ìŠµë‹ˆë‹¤."

- ì§ì ‘ êµ¬í˜„: í•™ìŠµê³¼ ì´í•´ë¥¼ ìœ„í•´
- ì‹¤ë¬´ ì‚¬ìš©: ê²€ì¦ëœ ë¼ì´ë¸ŒëŸ¬ë¦¬ í™œìš©
```